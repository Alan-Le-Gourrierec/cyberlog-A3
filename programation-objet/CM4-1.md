## 6- les contract 

programme fiable :
- correct fait ce qu'il dois faire
- robuste : réaction dans le but de ne pas planté comme un clochard 

Le programme dois être fiable mais pas forcément robust 
- programme de test si il plante on s'en fout 
- programme pour piloter un avions bah si il plante on est un peu dans la merde 

Le but dans le cadre d'un contrat est de respecter les demandes du client et le producteur (càd moi) le client dois respecter sa parts (càd me payer ou encore me respecter ses closes) et pour le producteur, il dois réaliser la demande du client même si elle est absurde.

```java
/**
* @inv balance >= floor
*/

public class BankAccount{
	private double balance;
	private double floor;

	BankAccount(double money, double min_money){
		this.balance = money;
		this.floor = min_money;
	}

	public void withdraw(double account){
		balance = balance - account;
	}
}
```

Il y à des préconditions et des posts condition. Dans l'exemple précédent les préconditions sont que nous ayons des doubles.

C'est au client de s'assurer qu'il entre le bon montant. Le fournisseur lui s'engage que l'on lui retire la bonne somme.  

En cas de non respect de contrat de la pars du client :
- sois on met un check avant vu que le client est un connard (approche defensive)
- on pars du principe que tout le monde respecte le contrat alors je fait mon taf pas plus. (programmation zen)

Les préconditions sont respecté par le client et les post condition par le producteur. => approche contractuel

```java
/**
* @inv balance >= floor
*/

public class BankAccount{
	private double balance;
	private double floor;

	BankAccount(double money, double min_money){
		this.balance = money;
		this.floor = min_money;
	}

	public void withdraw(double account){
		if(account - balance <= floor || account <= 0){
			throw new Exception("violation du contract");
		}
		balance = balance - account;
	}
}
```

programmation defensive.


La correction : 
assert permet de faire des test unitaires pour savoir si notre programme à ces pré/post conditions violé.

```java
//exemple dans le cadre d'un compte bancaire
public void withdraw ( double amount ){
// precondition
assert amount > 0 && amount <= ( balance - floor ) :
" precondition violated " ;

final double old_balance = this . balance ;
balance = balance - amount ;
// postcondition

assert balance == old_balance - amount :
" postcondition violated " ;
}
```

=> vérification de la correctness du programme

on peu faire du try catch 